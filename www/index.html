<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
<link href="jquery-mobile/jquery.mobile.theme-1.0.min.css" rel="stylesheet" type="text/css">
<link href="jquery-mobile/jquery.mobile.structure-1.0.min.css" rel="stylesheet" type="text/css">
<script src="jquery-mobile/jquery-1.6.4.min.js" type="text/javascript"></script>
<script type="text/javascript">
	$(document).ready(function() {
		var url = "http://education.shehzadazram.co.uk/jquery/phone_app/connect.php"; 
		$.post(url,{method:'logged_in'},function(data){
			if (data == "TRUE") {
				alert(data);
				window.location = "menu.html";
			}
		});
		
		//TODO check if user is properly being logged in as i still was logged in after a day!
		$("form").submit(function(e){
			var url = "http://education.shehzadazram.co.uk/jquery/phone_app/connect.php"; 
			e.preventDefault();
			$('input[type=submit]').attr("disabled","disabled");
			
			var u = $('input[name=username]').val();
			var p = $('input[name=password]').val();
			
			
			$("#error").html('loading.gif');
			$.post(url,{username:u, password:p, method:'login'},
				function(data){
					if ( data.error) {
						$("#error").html(data.error);
					} else {
						window.location = "menu.html";
					}
			},"json");
			$('input[type=submit]').removeAttr("disabled");
			return false;
		});
	});  
</script>
<script src="jquery-mobile/jquery.mobile-1.0.min.js" type="text/javascript"></script>
</head>

<body>

<div data-role="page" id="app_login" data-theme="e">
	
    <div data-role="header"  data-theme="e">
    	<h1>Login</h1>
  	</div>
  	
    <div data-role="content" data-theme="e">      
        <div id="error"></div>
        
        <form action="" method="post">
        	<label>username</label>
            <input type="text" name="username" required/>
            
            <label>password</label>
            <input type="password" name="password" required/>
            
            <input type="submit" name="login" value="Log in" />
            
        </form>
    
   	</div>
    
  	<div data-role="footer" data-theme="e">
    	<h4>App Name &copy; 2013</h4>
  	</div>
    
</div>

</body>
</html>
